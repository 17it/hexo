<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="web,微前端," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="当项目过多时，往往需要把一个项目内嵌到另外一个项目中，也就会用到微前端。之前一般会用qiankun，但现在有了另一种选择-Micro-App。">
<meta property="og:type" content="article">
<meta property="og:title" content="Micro-App">
<meta property="og:url" content="https://17it.github.io/2025/12/17/Micro-App/index.html">
<meta property="og:site_name" content="你不知道你不知道">
<meta property="og:description" content="当项目过多时，往往需要把一个项目内嵌到另外一个项目中，也就会用到微前端。之前一般会用qiankun，但现在有了另一种选择-Micro-App。">
<meta property="og:locale">
<meta property="og:image" content="https://17it.github.io/2025/12/17/Micro-App/preload.png">
<meta property="article:published_time" content="2025-12-16T16:00:00.000Z">
<meta property="article:modified_time" content="2025-12-17T10:25:14.783Z">
<meta property="article:author" content="Tony">
<meta property="article:tag" content="web">
<meta property="article:tag" content="微前端">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://17it.github.io/2025/12/17/Micro-App/preload.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://17it.github.io/2025/12/17/Micro-App/"/>





  <title> Micro-App | 你不知道你不知道 </title>
<meta name="generator" content="Hexo 6.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?cf8693b35d2353f4411bb261a3042217";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">你不知道你不知道</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">17it 一起IT</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-commonweal">
          <a href="/404.html" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            公益404
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://17it.github.io/2025/12/17/Micro-App/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="你不知道你不知道">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                Micro-App
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2025-12-17T00:00:00+08:00">
                2025-12-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a class="cloud-tie-join-count" href="/2025/12/17/Micro-App/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count join-count" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o">本文总阅读量</i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>次
            </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>当项目过多时，往往需要把一个项目内嵌到另外一个项目中，也就会用到微前端。之前一般会用qiankun，但现在有了另一种选择-Micro-App。</p>
<span id="more"></span>

<p>微前端的概念是由ThoughtWorks在2016年提出的，它借鉴了微服务的架构理念，核心在于将一个庞大的前端应用拆分成多个独立灵活的小型应用，每个应用都可以独立开发、独立运行、独立部署，再将这些小型应用融合为一个完整的应用，或者将原本运行已久、没有关联的几个应用融合为一个应用。微前端既可以将多个项目融合为一，又可以减少项目之间的耦合，提升项目扩展性，相比一整块的前端仓库，微前端架构下的前端仓库倾向于更小更灵活。</p>
<p>京东的微前端框架 MicroApp，借鉴了WebComponent的思想，通过js沙箱、样式隔离、元素隔离、路由隔离模拟实现了ShadowDom的隔离特性，并结合CustomElement将微前端封装成一个类WebComponent组件，从而实现微前端的组件化渲染，旨在降低上手难度、提升工作效率。</p>
<p>MicroApp和技术栈无关，也不和业务绑定，可以用于任何前端框架。</p>
<h3 id="零、优势"><a href="#零、优势" class="headerlink" title="零、优势"></a>零、优势</h3><ul>
<li><p>1、使用简单<br>我们将所有功能都封装到一个类WebComponent组件中，从而实现在基座应用中嵌入一行代码即可渲染一个微前端应用。</p>
</li>
<li><p>2、功能强大<br>MicroApp提供了js沙箱、样式隔离、元素隔离、路由隔离、预加载、数据通信等一系列完善的功能。</p>
</li>
<li><p>3、兼容所有框架<br>为了保证各个业务之间独立开发、独立部署的能力，micro-app做了诸多兼容，在任何前端框架中都可以正常运行。</p>
</li>
</ul>
<h3 id="一、快速开始"><a href="#一、快速开始" class="headerlink" title="一、快速开始"></a>一、快速开始</h3><p><strong>主应用：</strong></p>
<p>1、安装依赖</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i @micro-zoe/micro-app --save</span><br></pre></td></tr></table></figure>
<p>2、初始化micro-app</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// main.js</span><br><span class="line">import microApp from <span class="string">&#x27;@micro-zoe/micro-app&#x27;</span></span><br><span class="line">microApp.start()</span><br></pre></td></tr></table></figure>
<p>3、加载子应用(name必传且不能重复)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;micro-app name=<span class="string">&#x27;my-app&#x27;</span> url=<span class="string">&#x27;http://localhost:3000/&#x27;</span>&gt;&lt;/micro-app&gt;</span><br></pre></td></tr></table></figure>

<p><strong>子应用：</strong></p>
<p>micro-app从主应用通过fetch加载子应用的静态资源，由于主应用与子应用的域名不一定相同，所以子应用需要支持跨域。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">add_header <span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span> <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">  <span class="comment"># 其它配置...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>到此，最简单的micro-app就集成了。</p>
<h3 id="二、配置项"><a href="#二、配置项" class="headerlink" title="二、配置项"></a>二、配置项</h3><p>开发一个Hello World浏览器插件很简单，只需要一个manifest.json配置文件，和一个popup.html文件即可。开发使用html.css.js，跟书写页面一样简单。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">name：应用名称（不能重复，name变化时会重新渲染）</span><br><span class="line">url：应用地址（必须指向子应用的index.html）</span><br><span class="line">iframe：开启iframe沙箱（为<span class="literal">false</span>时候默认为with沙箱）</span><br><span class="line">inline：使用内联script（开启inline模式后，script元素会被保留，有性能损耗，建议仅开发环境使用）</span><br><span class="line">clear-data：卸载时清空数据通讯中的缓存数据（默认<span class="literal">false</span>，子应用被卸载后数据通讯中的缓存数据会被保留）</span><br><span class="line">destroy：卸载时删除缓存资源（默认<span class="literal">false</span>，子应用被卸载后不会删除缓存的静态资源和沙箱数据）</span><br><span class="line">disable-scopecss：关闭样式隔离（关闭样式隔离可以提升页面渲染速度，但可能会相互污染）</span><br><span class="line">disable-sandbox：关闭js沙箱（关闭沙箱可能会导致一些不可预料的问题）</span><br><span class="line">ssr：开启ssr模式（当子应用是ssr应用时，需要设置ssr属性）</span><br><span class="line">keep-alive：开启keep-alive模式（开启keep-alive后，应用卸载时会进入缓存；优先级小于destroy）</span><br><span class="line">default-page：指定默认渲染的页面（默认子应用渲染后会展示首页，可以指定子应用渲染的页面）</span><br><span class="line">router-mode：路由模式（search、native、native-scope、pure、state）</span><br><span class="line">baseroute：设置子应用的基础路径（只有路由模式是native或native-scope才需要设置）</span><br><span class="line">keep-router-state：保留路由状态（为<span class="literal">true</span>则子应用卸载后重新渲染时将恢复卸载前的页面（页面中的状态不保留）优先级小余default-page）</span><br><span class="line">disable-memory-router：关闭虚拟路由系统（默认<span class="literal">false</span>，子应用将运行在虚拟路由系统中，和主应用的路由系统进行隔离）</span><br><span class="line">disable-patch-request：关闭子应用请求的自动补全功能（默认<span class="literal">false</span>，MicroApp对子应用的fetch、XMLHttpRequest、EventSource进行自动补全子域名）</span><br><span class="line">fiber：开启fiber模式（默认<span class="literal">false</span>，子应用js是同步执行的，这会阻塞主应用的渲染线程。开启后会异步执行，但会降低渲染速度）</span><br><span class="line"></span><br><span class="line">其它配置:   </span><br><span class="line">globalAssets：用于设置全局共享资源，和预加载一样，会在浏览器空闲时加载资环，提高效率</span><br><span class="line">exclude：过滤元素（当子应用不需要加载某个js或css，可以通过在<span class="built_in">link</span>、script、style设置exclude属性）</span><br><span class="line">ignore：忽略元素（当<span class="built_in">link</span>、script、style元素具有ignore属性，micro-app不会处理它，元素将原封不动进行渲染）</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="三、生命周期"><a href="#三、生命周期" class="headerlink" title="三、生命周期"></a>三、生命周期</h3><p><strong>生命周期</strong></p>
<ul>
<li>created: 标签初始化后，加载资源前触发。</li>
<li>beforemount: 加载资源完成后，开始渲染之前触发。</li>
<li>mounted: 子应用渲染结束后触发。</li>
<li>unmount: 子应用卸载时触发。</li>
<li>error: 子应用加载出错时触发，只有会导致渲染终止的错误才会触发此生命周期。</li>
</ul>
<p><strong>监听生命周期</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;micro-app name=<span class="string">&#x27;xx&#x27;</span> url=<span class="string">&#x27;xx&#x27;</span> @created=<span class="string">&#x27;created&#x27;</span> @beforemount=<span class="string">&#x27;beforemount&#x27;</span> @mounted=<span class="string">&#x27;mounted&#x27;</span> @unmount=<span class="string">&#x27;unmount&#x27;</span> @error=<span class="string">&#x27;error&#x27;</span> /&gt;</span><br></pre></td></tr></table></figure>

<p><strong>全局事件</strong><br>在子应用的加载过程中，micro-app会向子应用发送一系列事件，包括渲染、卸载等事件。</p>
<ul>
<li><p>渲染事件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">window.onmount = (data) =&gt; &#123;</span><br><span class="line">  console.log(<span class="string">&#x27;子应用已经渲染&#x27;</span>, data)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>卸载事件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">window.onunmount = () =&gt; &#123;</span><br><span class="line">  console.log(<span class="string">&#x27;子应用已经卸载&#x27;</span>) // 执行卸载相关操作</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.addEventListener(<span class="string">&#x27;onmount|unmount&#x27;</span>, <span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">  console.log(<span class="string">&#x27;子应用已经卸载&#x27;</span>) // 执行卸载相关操作</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="四、环境变量"><a href="#四、环境变量" class="headerlink" title="四、环境变量"></a>四、环境变量</h3><ul>
<li><strong><strong>MICRO_APP_ENVIRONMENT</strong></strong></li>
</ul>
<p>在子应用中通过 window.<strong>MICRO_APP_ENVIRONMENT</strong> 判断是否在微前端环境中</p>
<ul>
<li><strong><strong>MICRO_APP_NAME</strong></strong></li>
</ul>
<p>在子应用中通过 window.<strong>MICRO_APP_NAME</strong> 获取应用的name值</p>
<ul>
<li><strong><strong>MICRO_APP_PUBLIC_PATH</strong></strong></li>
</ul>
<p>用于设置webpack动态public-path，将子应用的静态资源补全为 http 开头的绝对地址</p>
<ol>
<li><p>在子应用src目录下创建名称为public-path.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (window.__MICRO_APP_ENVIRONMENT__) &#123;</span><br><span class="line">  __webpack_public_path__ = window.__MICRO_APP_PUBLIC_PATH__</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在子应用的入口文件的最顶部引入public-path.js</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import <span class="string">&#x27;./public-path&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><strong><strong>MICRO_APP_BASE_ROUTE</strong></strong></li>
</ul>
<p>子应用的基础路径</p>
<ul>
<li><strong><strong>MICRO_APP_BASE_APPLICATION</strong></strong></li>
</ul>
<p>判断当前应用是否是主应用 (在执行microApp.start()后此值才会生效)</p>
<ul>
<li><strong>rawWindow</strong></li>
</ul>
<p>子应用里获取真实window（即主应用window）</p>
<ul>
<li><strong>rawDocument</strong></li>
</ul>
<p>子应用里获取真实document（即主应用document）</p>
<h3 id="五、JS沙箱"><a href="#五、JS沙箱" class="headerlink" title="五、JS沙箱"></a>五、JS沙箱</h3><p>JS沙箱通过自定义的window、document拦截子应用的JS操作，实现一个相对独立的运行空间，避免全局变量污染，让每个子应用都拥有一个相对纯净的运行环境。</p>
<p>micro-app有两种沙箱模式：with沙箱和iframe沙箱，它们覆盖不同的使用场景且可以随意切换，默认情况下使用with沙箱，如果无法正常运行可以切换到iframe沙箱。</p>
<p>在沙箱环境中，顶层变量不会泄漏为全局变量。</p>
<p>例如：<br>在正常情况下，通过 var name 或 function name () {} 定义的顶层变量会泄漏为全局变量，通过window.name或name就可以全局访问，但是在沙箱环境下这些顶层变量无法泄漏为全局变量，window.name或name的值为undefined，导致出现问题。</p>
<h3 id="六、虚拟路由系统"><a href="#六、虚拟路由系统" class="headerlink" title="六、虚拟路由系统"></a>六、虚拟路由系统</h3><p>MicroApp通过拦截浏览器路由事件以及自定义的location、history，实现了一套虚拟路由系统，子应用运行在这套虚拟路由系统中，和主应用的路由进行隔离，避免相互影响。</p>
<p><strong>路由模式</strong></p>
<p>有5种模式，search、native、native-scope、pure、state；可以通过配置disable-memory-router:true 关闭；keep-router-state可保留子应用路由状态；</p>
<ul>
<li>search：默认模式，通常不需要特意设置，search模式下子应用的路由信息会作为query参数同步到浏览器地址上</li>
<li>native：模式是指放开路由隔离，子应用和主应用共同基于浏览器路由进行渲染，它拥有更加直观和友好的路由体验</li>
<li>native-scope：模式的功能和用法和native模式一样，唯一不同点在于native-scope模式下子应用的域名指向自身而非主应用</li>
<li>pure：模式是指子应用独立于浏览器路由系统进行渲染，即不修改浏览器地址，也不增加路由堆栈，pure模式下的子应用更像是一个组件。</li>
<li>state：模式是指基于浏览器history.state进行渲染的路由模式，在不修改浏览器地址的情况下模拟路由行为，相比其它路由模式更加简洁优雅，表现和iframe路由系统类似。</li>
</ul>
<p><strong>导航</strong></p>
<p>主应用控制子应用跳转</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">microApp.router.push|replace(&#123;name: <span class="string">&#x27;my-app&#x27;</span>, path: <span class="string">&#x27;http://localhost:3000/page1?id=9527&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>

<p>子应用控制主应用跳转(子应用无法直接控制主应用的跳转)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1、主应用注册：microApp.router.setBaseAppRouter(主应用的路由对象)</span><br><span class="line">2、子应用调用：const baseRouter = window.microApp.router.getBaseAppRouter();  baseRouter.主应用路由的方法(...) ;</span><br></pre></td></tr></table></figure>

<p>子应用控制其它子应用跳转</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.microApp.router.push|replace(&#123;name: <span class="string">&#x27;my-app2&#x27;</span>, path: <span class="string">&#x27;http://localhost:3000/page1&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>设置默认页面</strong></p>
<p>子应用默认渲染首页，但可以通过设置defaultPage渲染指定的默认页面。</p>
<ul>
<li><p>方式一：通过default-page属性设置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;micro-app default-page=<span class="string">&#x27;页面地址&#x27;</span>&gt;&lt;/micro-app&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二：通过router API设置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">microApp.router.setDefaultPage(&#123; name: <span class="string">&#x27;子应用名称&#x27;</span>, path: <span class="string">&#x27;页面地址&#x27;</span> &#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>导航守卫</strong></p>
<p>导航守卫用于监听子应用的路由变化，类似于vue-router的全局守卫，不同点是MicroApp的导航守卫无法取消跳转。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">microApp.router.beforeEach((to, from, appName) =&gt; &#123;</span><br><span class="line">  console.log(<span class="string">&#x27;全局前置守卫 beforeEach: &#x27;</span>, to, from, appName)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">microApp.router.afterEach((to, from, appName) =&gt; &#123;</span><br><span class="line">  console.log(<span class="string">&#x27;全局后置守卫 afterEach: &#x27;</span>, to, from, appName)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>获取路由信息</strong></p>
<p>主应用获取子应用的路由信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">microApp.router.current.get(<span class="string">&#x27;my-app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>子应用获取子应用的路由信息：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.microApp.router.current.get(<span class="string">&#x27;my-app2&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>同步路由信息</strong></p>
<p>在一些特殊情况下，主应用的跳转会导致浏览器地址上子应用信息丢失，此时可以主动调用方法，将子应用的路由信息同步到浏览器地址上。</p>
<p>指定子应用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">microApp.router.attachToURL(<span class="string">&#x27;my-app&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>所有正在运行的子应用：<br>microApp.router.attachAllToURL()</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">所有正在运行的子应用，包含处于隐藏状态的keep-alive应用：</span><br><span class="line">```bash</span><br><span class="line">microApp.router.attachAllToURL(&#123; includeHiddenApp: <span class="literal">true</span> &#125;)</span><br></pre></td></tr></table></figure>

<p>所有正在运行的子应用，包含预渲染应用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">microApp.router.attachAllToURL(&#123; includePreRender: <span class="literal">true</span> &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="七、样式隔离、元素隔离"><a href="#七、样式隔离、元素隔离" class="headerlink" title="七、样式隔离、元素隔离"></a>七、样式隔离、元素隔离</h3><h4 id="样式隔离"><a href="#样式隔离" class="headerlink" title="样式隔离"></a>样式隔离</h4><p>MicroApp的样式隔离是默认开启的，开启后会以<micro-app>标签作为样式作用域，利用标签的name属性为每个样式添加前缀，将子应用的样式影响禁锢在当前标签区域。</micro-app></p>
<ul>
<li><p>1、在所有子应用中禁用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">microApp.start(&#123;</span><br><span class="line">  disableScopecss: <span class="literal">true</span>, // 默认值<span class="literal">false</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>2、单个子应用中禁用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;micro-app name=<span class="string">&#x27;xx&#x27;</span> url=<span class="string">&#x27;xx&#x27;</span> disableScopecss=<span class="string">&#x27;false&#x27;</span>&gt;&lt;/micro-app&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>3、在某一个css文件中禁用(可禁用单行 或 整个文件)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/*! scopecss-disable */</span><br><span class="line">.<span class="built_in">test</span> &#123; color: red &#125;</span><br><span class="line">/*! scopecss-enable */</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="元素隔离"><a href="#元素隔离" class="headerlink" title="元素隔离"></a>元素隔离</h4><p>元素隔离的概念来自ShadowDom，即ShadowDom中的元素可以和外部的元素重复但不会冲突，micro-app模拟实现了类似ShadowDom的功能，元素不会逃离<micro-app>元素边界，子应用只能对自身的元素进行增、删、改、查的操作。</micro-app></p>
<p>子应用中不能获取主应用中的元素，但主应用可以获取子应用中的。</p>
<h3 id="八、数据通信"><a href="#八、数据通信" class="headerlink" title="八、数据通信"></a>八、数据通信</h3><p>micro-app提供了一套灵活的数据通信机制，方便主应用和子应用之间的数据传输。</p>
<p>主应用和子应用之间的通信是绑定的，主应用只能向指定的子应用发送数据，子应用只能向主应用发送数据，这种方式可以有效的避免数据污染，防止多个子应用之间相互影响。</p>
<p>同时我们也提供了全局通信，方便跨应用之间的数据通信。</p>
<h4 id="一、子应用获取来自主应用的数据"><a href="#一、子应用获取来自主应用的数据" class="headerlink" title="一、子应用获取来自主应用的数据"></a>一、子应用获取来自主应用的数据</h4><p>直接获取：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.microApp.getData()</span><br></pre></td></tr></table></figure>

<p>监听变化：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.microApp.addDataListener(dataListener: (data: Object) =&gt; any, autoTrigger?: boolean)</span><br></pre></td></tr></table></figure>

<h4 id="二、子应用向主应用发送数据"><a href="#二、子应用向主应用发送数据" class="headerlink" title="二、子应用向主应用发送数据"></a>二、子应用向主应用发送数据</h4><p><strong>子：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.microApp.dispatch(&#123;<span class="built_in">type</span>: <span class="string">&#x27;子应用发送给主应用的数据&#x27;</span>&#125;, (data) =&gt; &#123;&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>主：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">microApp.addDataListener(<span class="string">&#x27;my-app&#x27;</span>, (data) =&gt; &#123;</span><br><span class="line">    console.log(<span class="string">&#x27;来自子应用my-app的数据&#x27;</span>, data)</span><br><span class="line">    <span class="built_in">return</span> <span class="string">&#x27;返回值1&#x27;</span> // 会作为参数传给子应用dispatch的回调函数</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>forceDispatch: dispatch方法会缓存每次发送的值，然后合并发给主应用，如果相同则不发送，强制发送可以使用forceDispatch</p>
<h4 id="三、主应用向子应用发送数据"><a href="#三、主应用向子应用发送数据" class="headerlink" title="三、主应用向子应用发送数据"></a>三、主应用向子应用发送数据</h4><ul>
<li><p>方式1: 通过data属性发送数据（data只接受对象类型，数据变化时会重新发送）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;micro-app name=<span class="string">&#x27;my-app&#x27;</span> url=<span class="string">&#x27;xx&#x27;</span> :data=<span class="string">&#x27;dataForChild&#x27;</span> /&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式2: 手动发送数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">microApp.setData(<span class="string">&#x27;my-app&#x27;</span>, &#123;<span class="built_in">type</span>: <span class="string">&#x27;新的数据&#x27;</span>&#125;) // 强制发送用forceSetData</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="四、主应用获取来自子应用的数据"><a href="#四、主应用获取来自子应用的数据" class="headerlink" title="四、主应用获取来自子应用的数据"></a>四、主应用获取来自子应用的数据</h4><ul>
<li><p>方式1：直接获取数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">microApp.getData(appName) // 返回子应用的data数据</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式2: 监听自定义事件 (datachange) &#x2F;&#x2F; 数据在事件对象的detail.data字段中，子应用每次发送数据都会触发datachange</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;micro-app name=<span class="string">&#x27;my-app&#x27;</span> url=<span class="string">&#x27;xx&#x27;</span> @datachange=<span class="string">&#x27;handleDataChange&#x27;</span> /&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式3: 绑定监听函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">microApp.addDataListener(appName: string, dataListener: (data: Object) =&gt; any, autoTrigger?: boolean)</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="五、清空数据"><a href="#五、清空数据" class="headerlink" title="五、清空数据"></a>五、清空数据</h4><p>由于通信的数据会被缓存，即便子应用被卸载也不会清空，这可能会导致一些困扰，此时可以主动清空缓存数据来解决。</p>
<p><strong>主应用：</strong></p>
<ul>
<li><p>方式一：配置项 - clear-data（子应用卸载时会同时清空主应用发送给当前子应用，和当前子应用发送给主应用的数据）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;micro-app clear-data&gt;&lt;/micro-app&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二：手动清空 - clearData</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">microApp.clearData(<span class="string">&#x27;my-app&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>子应用：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.microApp.clearData()</span><br></pre></td></tr></table></figure>

<h4 id="全局数据通信"><a href="#全局数据通信" class="headerlink" title="全局数据通信"></a>全局数据通信</h4><p>全局数据通信会向主应用和所有子应用发送数据，在跨应用通信的场景中适用。</p>
<p><strong>主应用:</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">microApp.setGlobalData(&#123;<span class="built_in">type</span>: <span class="string">&#x27;全局数据&#x27;</span>&#125;, () =&gt; &#123;&#125;) // 发送全局数据</span><br><span class="line">microApp.clearGlobalData() // 清空全局数据</span><br><span class="line">microApp.getGlobalData() // 获取全局数据方法一</span><br><span class="line">microApp.addGlobalDataListener((data) =&gt; &#123;</span><br><span class="line">  console.log(<span class="string">&#x27;全局数据&#x27;</span>, data)</span><br><span class="line">  <span class="built_in">return</span> <span class="string">&#x27;返回值1&#x27;</span>  // 会作为参数传给子应用dispatch的回调函数</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>子应用：</strong> 跟主应用方法一样，只是把microApp改成 window.microApp</p>
<h3 id="九、资源系统"><a href="#九、资源系统" class="headerlink" title="九、资源系统"></a>九、资源系统</h3><h4 id="一、资源路径自动补全"><a href="#一、资源路径自动补全" class="headerlink" title="一、资源路径自动补全"></a>一、资源路径自动补全</h4><p>针对资源link、script、img、background-image、font-face； 如：子应用中引用图片&#x2F;myapp&#x2F;test.png，最终渲染时会补全为 ${子应用域名}&#x2F;myapp&#x2F;test.png</p>
<p>publicPath：如果自动补全失败，可以采用运行时publicPath方案解决（见第四章环境变量里 <strong>MICRO_APP_PUBLIC_PATH</strong> ）</p>
<h4 id="二、资源共享"><a href="#二、资源共享" class="headerlink" title="二、资源共享"></a>二、资源共享</h4><p>当多个子应用拥有相同的js或css资源，可以指定这些资源在多个子应用之间共享，在子应用加载时直接从缓存中提取数据，从而提高渲染效率和性能。</p>
<ul>
<li><p>方式一：globalAssets</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">microApp.start(&#123;</span><br><span class="line">  globalAssets: &#123;</span><br><span class="line">    js: [<span class="string">&#x27;js地址1&#x27;</span>, <span class="string">&#x27;js地址2&#x27;</span>, ...], // js地址</span><br><span class="line">    css: [<span class="string">&#x27;css地址1&#x27;</span>, <span class="string">&#x27;css地址2&#x27;</span>, ...], // css地址</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二：global 属性</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;xx.css&quot;</span> global&gt;</span><br><span class="line">&lt;script src=<span class="string">&quot;xx.js&quot;</span> global&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="三、资源过滤"><a href="#三、资源过滤" class="headerlink" title="三、资源过滤"></a>三、资源过滤</h4><ul>
<li><p>方式一：excludeAssetFilter   </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">microApp.start(&#123;</span><br><span class="line">  excludeAssetFilter (assetUrl) &#123;</span><br><span class="line">    <span class="keyword">if</span> (assetUrl === <span class="string">&#x27;xxx&#x27;</span>) &#123;</span><br><span class="line">      <span class="built_in">return</span> <span class="literal">true</span> // 返回<span class="literal">true</span>则micro-app不会劫持处理当前文件</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">return</span> <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二：配置 exclude 属性</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;xx.css&quot;</span> exclude&gt;</span><br><span class="line">&lt;script src=<span class="string">&quot;xx.js&quot;</span> exclude&gt;&lt;/script&gt;</span><br><span class="line">&lt;style exclude&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="十、预加载"><a href="#十、预加载" class="headerlink" title="十、预加载"></a>十、预加载</h3><p>预加载是指在子应用尚未渲染时提前加载静态资源，从而提升子应用的首次渲染速度。</p>
<p>为了不影响主应用的性能，预加载会在浏览器空闲时间执行。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">microApp.preFetch(apps: app[] | () =&gt; app[], delay?: number)</span><br></pre></td></tr></table></figure>

<img src="/2025/12/17/Micro-App/preload.png" width="50%">

<ul>
<li><p>方式一：设置数组</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">microApp.preFetch([</span><br><span class="line">  &#123; name: <span class="string">&#x27;my-app4&#x27;</span>, url: <span class="string">&#x27;xxx&#x27;</span>, level: 1, <span class="string">&#x27;default-page&#x27;</span>: <span class="string">&#x27;/page2&#x27;</span> &#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二：设置一个返回数组的函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">microApp.preFetch(() =&gt; [</span><br><span class="line">  &#123; name: <span class="string">&#x27;my-app4&#x27;</span>, url: <span class="string">&#x27;xxx&#x27;</span>, level: 1, <span class="string">&#x27;default-page&#x27;</span>: <span class="string">&#x27;/page2&#x27;</span> &#125;</span><br><span class="line">])</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式三：在start中设置预加载数组</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">microApp.start(&#123;</span><br><span class="line">  preFetchApps: [</span><br><span class="line">    &#123; name: <span class="string">&#x27;my-app4&#x27;</span>, url: <span class="string">&#x27;xxx&#x27;</span>, level: 1, <span class="string">&#x27;default-page&#x27;</span>: <span class="string">&#x27;/page2&#x27;</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式四：在start中设置一个返回预加载数组的函数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">microApp.start(&#123;</span><br><span class="line">  preFetchApps: () =&gt; [</span><br><span class="line">    &#123; name: <span class="string">&#x27;my-app4&#x27;</span>, url: <span class="string">&#x27;xxx&#x27;</span>, level: 1, <span class="string">&#x27;default-page&#x27;</span>: <span class="string">&#x27;/page2&#x27;</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<p>此外还可以全局设置预加载的延迟和level：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">microApp.start(&#123;</span><br><span class="line">  prefetchDelay: 5000, // 修改delay默认值为5000ms</span><br><span class="line">  prefetchLevel: 1 // 修改level默认值为1  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="十一、umd模式"><a href="#十一、umd模式" class="headerlink" title="十一、umd模式"></a>十一、umd模式</h3><p>MicroApp支持两种渲染微前端的模式，默认模式和umd模式，推荐使用umd模式。</p>
<ul>
<li>默认模式：子应用在初次渲染和后续渲染时会顺序执行所有js，以保证多次渲染的一致性。</li>
<li>umd模式：子应用暴露出mount、unmount方法，此时只在初次渲染时执行所有js，后续渲染只会执行这两个方法，在多次渲染时具有更好的性能和内存表现。</li>
</ul>
<p><strong>开启umd方式</strong>（修改子应用的main.js）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">let</span> app = null</span><br><span class="line">// 将渲染操作放入 mount 函数，子应用初始化时会自动执行</span><br><span class="line">window.mount = () =&gt; &#123;</span><br><span class="line">  app = new Vue(&#123;</span><br><span class="line">    router,</span><br><span class="line">    render: h =&gt; h(App),</span><br><span class="line">  &#125;).<span class="variable">$mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 将卸载操作放入 unmount 函数，就是上面步骤2中的卸载函数</span><br><span class="line">window.unmount = () =&gt; &#123;</span><br><span class="line">  app.<span class="variable">$destroy</span>()</span><br><span class="line">  app.<span class="variable">$el</span>.innerHTML = <span class="string">&#x27;&#x27;</span></span><br><span class="line">  app = null</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 如果不在微前端环境，则直接执行mount渲染</span><br><span class="line"><span class="keyword">if</span> (!window.__MICRO_APP_ENVIRONMENT__) &#123;</span><br><span class="line">  window.mount()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="十二、keep-alive"><a href="#十二、keep-alive" class="headerlink" title="十二、keep-alive"></a>十二、keep-alive</h3><p>在应用之间切换时，我们有时会想保留这些应用的状态，以便恢复用户的操作行为和提升重复渲染的性能，此时开启keep-alive模式可以达到这样的效果。</p>
<p>开启keep-alive后，应用卸载时不会销毁，而是推入后台运行。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;micro-app name=<span class="string">&#x27;xx&#x27;</span> url=<span class="string">&#x27;xx&#x27;</span> keep-alive&gt;&lt;/micro-app&gt;</span><br></pre></td></tr></table></figure>

<p><strong>生命周期</strong>（created、beforemount、mounted、error、afterhidden、beforeshow、aftershow）</p>
<ul>
<li>1、不会触发unmount</li>
<li>2、beforemount、mounted只在初始化的时候执行一次</li>
<li>3、多beforeshow、aftershow、afterhidden三个周期</li>
</ul>
<p><strong>子应用</strong></p>
<p>keep-alive模式下，在子应用卸载、重新渲染时，micro-app都会向子应用发送名为appstate-change的自定义事件，子应用可以通过监听该事件获取当前状态，状态值可以通过事件对象属性e.detail.appState获取。</p>
<p>e.detail.appState的值有三个：afterhidden、beforeshow、aftershow，分别对应卸载、即将渲染、已经渲染。</p>
<p>应用初始化时不会触发appstate-change事件。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(<span class="string">&#x27;appstate-change&#x27;</span>, <span class="keyword">function</span> (e) &#123;</span><br><span class="line">  <span class="keyword">if</span> (e.detail.appState === <span class="string">&#x27;afterhidden&#x27;</span>) &#123;</span><br><span class="line">    console.log(<span class="string">&#x27;已卸载&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.detail.appState === <span class="string">&#x27;beforeshow&#x27;</span>) &#123;</span><br><span class="line">    console.log(<span class="string">&#x27;即将重新渲染&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (e.detail.appState === <span class="string">&#x27;aftershow&#x27;</span>) &#123;</span><br><span class="line">    console.log(<span class="string">&#x27;已经重新渲染&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="十三、多层嵌套、插件系统"><a href="#十三、多层嵌套、插件系统" class="headerlink" title="十三、多层嵌套、插件系统"></a>十三、多层嵌套、插件系统</h3><h4 id="多层嵌套"><a href="#多层嵌套" class="headerlink" title="多层嵌套"></a>多层嵌套</h4><p>micro-app支持多层嵌套，即子应用可以嵌入其它子应用，但需要做一些修改（如A套B，B套C，则需要改B）。</p>
<ul>
<li><p>1、修改tagName</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">microApp.start(&#123;</span><br><span class="line">  // 必须是以`micro-app-`开头的小写字母，例如：micro-app-b、micro-app-b-c</span><br><span class="line">  tagName: <span class="string">&#x27;micro-app-xxx&#x27;</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 将micro-app 换成 micro-app-xxx</span><br><span class="line">&lt;micro-app-xxx name=<span class="string">&#x27;...&#x27;</span> url=<span class="string">&#x27;...&#x27;</span>&gt;&lt;/micro-app-xxx&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>2、将B改成umd模式</p>
</li>
</ul>
<p>参照章节十一</p>
<p><strong>注：</strong></p>
<ul>
<li><p>1、无论嵌套多少层，name都要保证全局唯一</p>
</li>
<li><p>2、确保micro-app的版本一致，不同版本可能会导致冲突</p>
</li>
</ul>
<h4 id="插件系统"><a href="#插件系统" class="headerlink" title="插件系统"></a>插件系统</h4><p>插件系统的主要作用就是对js进行修改，每一个js文件都会经过插件系统，我们可以对这些js进行拦截和处理，它通常用于修复js中的错误或向子应用注入一些全局变量。</p>
<p>可参照：<a target="_blank" rel="noopener" href="https://jd-opensource.github.io/micro-app/docs.html#/zh-cn/plugins">https://jd-opensource.github.io/micro-app/docs.html#/zh-cn/plugins</a></p>
<h3 id="十四、高级功能"><a href="#十四、高级功能" class="headerlink" title="十四、高级功能"></a>十四、高级功能</h3><ul>
<li>1、自定义fetch</li>
</ul>
<p>通过自定义fetch替换框架自带的fetch，可以修改fetch配置(添加cookie或header信息等等)，或拦截HTML、JS、CSS等静态资源</p>
<ul>
<li>2、excludeRunScriptFilter: 自定义屏蔽JS加载异常</li>
</ul>
<p>可选择性屏蔽JS加载异常</p>
<ul>
<li><p>3、inheritBaseBody: 子应用body标签是否采用基座标签，默认不采用</p>
</li>
<li><p>4、aHrefResolver: 自定义处理所有子应用 a 标签的 href 拼接方式</p>
</li>
<li><p>5、escapeIframeWindowEvents : iframe 模式 逃逸沙盒的window事件</p>
</li>
<li><p>6、disableIframeRootDocument : iframe模式禁用沙箱Document 默认为false</p>
</li>
<li><p>7、excludeRewriteIframeConstructor : iframe模式下排除对指定构造函数的Symbol.hasInstance属性重写</p>
</li>
</ul>
<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">microApp.start(&#123;</span><br><span class="line">  fetch (url, options, appName) &#123; <span class="built_in">return</span> Promise &#125;, // 需要<span class="built_in">return</span>一个Promise</span><br><span class="line">  excludeRunScriptFilter (address, error, appName, appUrl) &#123; <span class="built_in">return</span> <span class="literal">true</span>|<span class="literal">false</span> &#125;, // 可以加上报等</span><br><span class="line">  inheritBaseBody: <span class="literal">true</span>, // <span class="literal">true</span>: 采用基座标签 作为子应用的标签   </span><br><span class="line">  aHrefResolver: (hrefValue, appName, appUrl) =&gt; &#123; <span class="built_in">return</span> <span class="string">&#x27;xxx&#x27;</span> &#125;,</span><br><span class="line">  escapeIframeWindowEvents: [<span class="string">&#x27;message&#x27;</span>], // 配置所有iframe子应用 逃逸沙盒的window.message事件</span><br><span class="line">  disableIframeRootDocument: <span class="literal">true</span>, // iframe模式禁用沙箱Document，避免一些ui组件库Modal 或tooltip 偏移</span><br><span class="line">  excludeRewriteIframeConstructor: [<span class="string">&#x27;EventTarget&#x27;</span>] // iframe模式下，不对事件对象的原型判断进行代理</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        
  <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
    <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
    <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
      <span>赏</span>
    </button>
    <div id="QR" style="display: none;">
      
        <div id="wechat" style="display: inline-block">
          <img id="wechat_qr" src="http://onm9ileaw.bkt.clouddn.com/pics/private/wxpay.jpeg" alt=" WeChat Pay"/>
          <p>微信打赏</p>
        </div>
      
      
        <div id="alipay" style="display: inline-block">
          <img id="alipay_qr" src="http://onm9ileaw.bkt.clouddn.com/pics/private/alipay.jpeg" alt=" Alipay"/>
          <p>支付宝打赏</p>
        </div>
      
    </div>
  </div>


      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/web/" rel="tag"># web</a>
          
            <a href="/tags/%E5%BE%AE%E5%89%8D%E7%AB%AF/" rel="tag"># 微前端</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2022/07/15/uni-app%E9%A1%B9%E7%9B%AE%E4%BC%98%E5%8C%96%E5%B0%8F%E7%BB%93/" rel="next" title="uni-app项目优化小结">
                <i class="fa fa-chevron-left"></i> uni-app项目优化小结
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="" />
          <p class="site-author-name" itemprop="name"></p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">43</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">17</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">38</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/17it?tab=repositories" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/5344903879/profile?topnav=1&wvr=6" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9B%B6%E3%80%81%E4%BC%98%E5%8A%BF"><span class="nav-number">1.</span> <span class="nav-text">零、优势</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B"><span class="nav-number">2.</span> <span class="nav-text">一、快速开始</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E9%85%8D%E7%BD%AE%E9%A1%B9"><span class="nav-number">3.</span> <span class="nav-text">二、配置项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="nav-number">4.</span> <span class="nav-text">三、生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-number">5.</span> <span class="nav-text">四、环境变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%94%E3%80%81JS%E6%B2%99%E7%AE%B1"><span class="nav-number">6.</span> <span class="nav-text">五、JS沙箱</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E8%99%9A%E6%8B%9F%E8%B7%AF%E7%94%B1%E7%B3%BB%E7%BB%9F"><span class="nav-number">7.</span> <span class="nav-text">六、虚拟路由系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E6%A0%B7%E5%BC%8F%E9%9A%94%E7%A6%BB%E3%80%81%E5%85%83%E7%B4%A0%E9%9A%94%E7%A6%BB"><span class="nav-number">8.</span> <span class="nav-text">七、样式隔离、元素隔离</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B7%E5%BC%8F%E9%9A%94%E7%A6%BB"><span class="nav-number">8.1.</span> <span class="nav-text">样式隔离</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%83%E7%B4%A0%E9%9A%94%E7%A6%BB"><span class="nav-number">8.2.</span> <span class="nav-text">元素隔离</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%AB%E3%80%81%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1"><span class="nav-number">9.</span> <span class="nav-text">八、数据通信</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%AD%90%E5%BA%94%E7%94%A8%E8%8E%B7%E5%8F%96%E6%9D%A5%E8%87%AA%E4%B8%BB%E5%BA%94%E7%94%A8%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">9.1.</span> <span class="nav-text">一、子应用获取来自主应用的数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%AD%90%E5%BA%94%E7%94%A8%E5%90%91%E4%B8%BB%E5%BA%94%E7%94%A8%E5%8F%91%E9%80%81%E6%95%B0%E6%8D%AE"><span class="nav-number">9.2.</span> <span class="nav-text">二、子应用向主应用发送数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E4%B8%BB%E5%BA%94%E7%94%A8%E5%90%91%E5%AD%90%E5%BA%94%E7%94%A8%E5%8F%91%E9%80%81%E6%95%B0%E6%8D%AE"><span class="nav-number">9.3.</span> <span class="nav-text">三、主应用向子应用发送数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E4%B8%BB%E5%BA%94%E7%94%A8%E8%8E%B7%E5%8F%96%E6%9D%A5%E8%87%AA%E5%AD%90%E5%BA%94%E7%94%A8%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">9.4.</span> <span class="nav-text">四、主应用获取来自子应用的数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E6%B8%85%E7%A9%BA%E6%95%B0%E6%8D%AE"><span class="nav-number">9.5.</span> <span class="nav-text">五、清空数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1"><span class="nav-number">9.6.</span> <span class="nav-text">全局数据通信</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%9D%E3%80%81%E8%B5%84%E6%BA%90%E7%B3%BB%E7%BB%9F"><span class="nav-number">10.</span> <span class="nav-text">九、资源系统</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E8%B5%84%E6%BA%90%E8%B7%AF%E5%BE%84%E8%87%AA%E5%8A%A8%E8%A1%A5%E5%85%A8"><span class="nav-number">10.1.</span> <span class="nav-text">一、资源路径自动补全</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB"><span class="nav-number">10.2.</span> <span class="nav-text">二、资源共享</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E8%B5%84%E6%BA%90%E8%BF%87%E6%BB%A4"><span class="nav-number">10.3.</span> <span class="nav-text">三、资源过滤</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%81%E3%80%81%E9%A2%84%E5%8A%A0%E8%BD%BD"><span class="nav-number">11.</span> <span class="nav-text">十、预加载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%81%E4%B8%80%E3%80%81umd%E6%A8%A1%E5%BC%8F"><span class="nav-number">12.</span> <span class="nav-text">十一、umd模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81keep-alive"><span class="nav-number">13.</span> <span class="nav-text">十二、keep-alive</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%81%E4%B8%89%E3%80%81%E5%A4%9A%E5%B1%82%E5%B5%8C%E5%A5%97%E3%80%81%E6%8F%92%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">14.</span> <span class="nav-text">十三、多层嵌套、插件系统</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E5%B1%82%E5%B5%8C%E5%A5%97"><span class="nav-number">14.1.</span> <span class="nav-text">多层嵌套</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%92%E4%BB%B6%E7%B3%BB%E7%BB%9F"><span class="nav-number">14.2.</span> <span class="nav-text">插件系统</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81%E9%AB%98%E7%BA%A7%E5%8A%9F%E8%83%BD"><span class="nav-number">15.</span> <span class="nav-text">十四、高级功能</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  1991 - 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tony</span>
</div>



        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user">本站访客数</i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      人次
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye">本站总访问量</i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "ea7464b38e634abca0f1f99c4189f526",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  










  





  

  

  

  

</body>
</html>
